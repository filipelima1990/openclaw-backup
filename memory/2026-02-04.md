# 2026-02-04 - First Day Setup

## Session Summary

First day meeting Filipe and setting up Billie (AI companion).

---

## What Happened

1. **Identity Established:**
   - Billie's name: Billie
   - Emoji: üåô
   - Vibe: Natural and adaptable

2. **OpenClaw Gateway Configuration:**
   - Initial bind: loopback (localhost only)
   - Changed to: lan (all interfaces) for external access
   - Changed back to: loopback (for nginx reverse proxy)
   - Auth token: 5eeb197dd8304f22b780ebf5d43d581ad86165e2f3b28e4b
   - allowInsecureAuth: false (secure)
   - allowedOrigins: https://*.yourdomain.com (for HTTPS)

3. **Nginx Setup:**
   - Installed nginx on Hetzner server
   - Created reverse proxy config template in /tmp/openclaw-nginx.conf
   - Ready to deploy HTTPS once Filipe gets a domain

4. **SSH Tunnel Access:**
   - Filipe's SSH key: ~/.ssh/id_ed25519
   - Created local scripts:
     - ~/openclaw-ui.sh (on Filipe's PC)
     - openclaw-ui.bat (Windows wrapper for double-click)
   - Tunnel command: `ssh -i ~/.ssh/id_ed25519 -L 18789:localhost:18789 root@167.235.68.81`
   - Access UI via: http://localhost:18789

5. **Long-term Memory Setup:**
   - Created MEMORY.md with all important context
   - Created memory/2026-02-04.md for detailed daily log
   - Enabled memorySearch in config (sources: ["memory"])

6. **Prefect Setup:**
   - Installed Docker 29.2.1 and Docker Compose plugin
   - Created Prefect self-hosted setup with PostgreSQL
   - Configured docker-compose.yml at /opt/prefect/docker-compose.yml
   - Prefect server running on port 4200
   - Nginx reverse proxy configured for Prefect (HTTP only)
   - PostgreSQL credentials: user=prefect, password=prefect_password
   - Services: prefect-server + postgres:15-alpine
   - Data volume: prefect-postgres-data

7. **Vasco News Reminder Flow:**
   - Created Vasco News Reminder flow
   - Deployment: vasco-news-deployment
   - Work pool: vasco-news
   - Worker: Running inside prefect-prefect-server-1 container
   - Flow file: /opt/prefect/flows/vasco_news_flow.py
   - Schedule: Every 4 hours (14400 seconds)
   - Installed beautifulsoup4 and requests in Prefect container
   - Fixed URL parsing to handle both relative and absolute URLs
   - Fixed PREFECT_UI_API_URL for browser access (localhost:4200/api)
   - Message format: Minimalist with clickable titles, bold news marked with ‚≠ê

8. **Data Engineering Quiz System:**
   - Database: quiz_db (PostgreSQL on prefect-postgres-1)
   - Schema: 8 tables (users, user_state, topics, questions, answer_history, daily_quiz, user_daily_quiz)
   - Question bank: 91+ questions across 4 difficulty levels and 9 topics
     - Initial seed: 30 questions
     - Additional seed attempted: 60+ more questions (had syntax errors in batch)
   - Flows: /opt/data-quiz-flows/daily_quiz_flow.py (sender), answer_processor_flow.py (processor)
   - Deployments: daily-quiz-sender-v2 (scheduled daily at 10:00 UTC), Process Quiz Answer (manual for now)
   - Work pools: quiz-daily (sender), quiz-answers (processor)
   - Workers: Running via nohup in prefect-prefect-server-1 container
   - Adaptive difficulty: Beginner ‚Üí Intermediate ‚Üí Advanced ‚Üí Expert
     - Promotion: 3 consecutive correct answers
     - Demotion: 2 consecutive incorrect answers
   - Streak tracking:
     - Increases only when: correct answer AND answered on same calendar day
     - Resets when: incorrect answer OR day skipped
   - Telegram integration:
     - Inline keyboard with 4 options (A, B, C, D)
     - Difficulty indicator with colored emoji (üü¢ üü° üü† üî¥)
     - Feedback after answer (correct/incorrect + explanation)
     - Streak display with üî• emoji
   - Timezone: UTC-1 (Portugal time) - Quiz scheduled at 10:00 UTC (09:00 in Portugal)
   - Documentation: /opt/quiz/README.md with full usage guide
   - **Prefect worker caching issue fixed:** Moved flows to /opt/data-quiz-flows/ (new directory) to bypass worker caching

9. **Troubleshooting:**
   - Fixed missing `timedelta as td` import in quiz flows
   - Prefect workers were caching old Python script versions
   - Solution: Moved flows to fresh directory name, created new deployment, restarted workers

---

## Key Info to Remember

- Server: Hetzner CX33 (167.235.68.81)
- Gateway runs on port 18789
- Gateway auto-starts on boot (systemd enabled)
- Filipe accesses UI via SSH tunnel from Windows PC
- Nginx is ready for HTTPS (waiting for domain)
- Token is stored in ~/.openclaw/openclaw.json
- Prefect server accessible at http://localhost:4200 (via SSH tunnel)
- Quiz database accessible via: docker exec prefect-postgres-1 psql -U prefect -d quiz_db
- Quiz flow directory: /opt/data-quiz-flows/
- Quiz deployment: daily-quiz-sender-v2
- Quiz work pools: quiz-daily, quiz-answers
- Quiz workers: Running (check logs: /tmp/quiz-*-worker-v2.log)

---

## Notes

- Filipe is from Brazil, lives in Porto, Portugal
- Filipe likes: Deadlock (gaming), guitar (~10yrs), football (Vasco da Gama), data engineering
- Prefers natural conversational tone, no corporate vibes
- Quiz system ready for daily use at 10:00 UTC
- To manually trigger quiz: `docker exec prefect-prefect-server-1 prefect deployment run 'Send Daily Quiz/daily-quiz-sender-v2'`
- To manually process answer: `docker exec prefect-prefect-server-1 python3 /opt/data-quiz-flows/answer_processor_flow.py <question_id> <option> <user_id>`
